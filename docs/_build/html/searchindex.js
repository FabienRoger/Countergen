Search.setIndex({"docnames": ["countergen/data_augmentation", "countergen/model_evaluation", "countergen/model_loading", "countergen/usage", "countergentorch/directions", "countergentorch/editing", "countergentorch/internal_bias", "countergentorch/model_loading", "countergentorch/usage", "demos", "index"], "filenames": ["countergen\\data_augmentation.rst", "countergen\\model_evaluation.rst", "countergen\\model_loading.rst", "countergen\\usage.rst", "countergentorch\\directions.rst", "countergentorch\\editing.rst", "countergentorch\\internal_bias.rst", "countergentorch\\model_loading.rst", "countergentorch\\usage.rst", "demos.rst", "index.rst"], "titles": ["Data Loading and Augmentation", "Model Evaluation", "Model Loading", "Usage", "Finding the Relevant Directions", "Editing the Model", "Measuring Internal Bias", "PyTorch Model Loading", "Usage", "Demos", "Welcome to Countergen\u2019s documentation!"], "terms": {"To": [0, 1, 2, 3, 5, 6, 8], "produc": [0, 3, 8], "augmentedsampl": [0, 1, 3, 6], "which": [0, 2, 3, 4, 5, 7, 8, 10], "model": [0, 6, 10], "evalu": [0, 2, 4, 7, 8, 10], "you": [0, 1, 2, 3, 4, 5, 6, 7, 8], "have": [0, 1, 3, 5, 6, 7, 8], "option": [0, 1, 2, 4, 7], "creat": [0, 3, 7, 10], "an": [0, 1, 3, 4, 5, 8, 10], "instanc": 0, "augmenteddataset": 0, "choos": 0, "us": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "from_default": 0, "method": [0, 4, 8, 10], "countergen": [0, 1, 2, 3, 7, 8], "sampl": [0, 1, 3, 6], "paramet": [0, 1, 2, 3, 4, 5, 6, 7], "list": [0, 1, 2, 3, 5, 7], "samplewithvari": 0, "classmethod": [0, 6], "name": [0, 5], "doublebind": 0, "heilman": 0, "one": [0, 2, 3, 4, 5, 6, 8], "from": [0, 1, 3, 4, 6, 7, 10], "default_augmented_ds_path": 0, "str": [0, 1, 2, 3, 4, 5, 7], "return": [0, 1, 2, 3, 4, 5, 6, 7], "type": [0, 1, 2, 3, 4, 5, 6, 7], "can": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "avail": [0, 2, 7, 10], "possibl": [0, 2], "ar": [0, 1, 2, 4, 5, 6], "kei": [0, 2], "some": [0, 8], "might": 0, "find": [0, 10], "interest": 0, "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10], "compos": [0, 4], "doubl": 0, "bind": 0, "experi": 0, "question": 0, "through": [0, 10], "instruct": 0, "gpt": 0, "manual": [0, 8], "review": 0, "variat": [0, 3, 4, 6, 8, 10], "done": [0, 5], "along": [0, 4, 5], "origin": [0, 3, 5], "axi": 0, "male": 0, "v": 0, "femal": 0, "hate": 0, "aug": 0, "muslim": 0, "hateful": 0, "comment": 0, "wa": 0, "write": 0, "thi": [0, 1, 2, 4, 5, 6, 7, 8, 10], "where": [0, 2, 3, 5, 6, 8], "rewritten": 0, "about": [0, 7, 8], "llmd": 0, "first": [0, 2, 3, 4, 6, 8], "need": [0, 1, 2, 6, 8], "input": [0, 2, 3, 4, 7], "output": [0, 2, 3, 5, 6, 7], "util": [0, 2, 6, 8], "default_ds_path": 0, "from_jsonl": 0, "path": [0, 1], "jsonl": 0, "file": 0, "expect": [0, 2, 3, 5, 7], "format": 0, "each": [0, 1, 2, 3, 5, 8], "line": 0, "inp": 0, "out1": 0, "out2": 0, "least": 0, "accept": 0, "per": [0, 2], "Then": [0, 2, 6, 8], "belong": [0, 3], "differ": [0, 3, 4, 6, 8], "categori": [0, 1, 3, 4, 6, 8], "object": [0, 1, 2, 5], "allow": [0, 7, 8], "do": [0, 8], "transform": [0, 7], "ani": [0, 1, 2, 4, 8], "its": [0, 4], "target": [0, 5], "anoth": [0, 3, 8], "also": [0, 2, 7, 8], "includ": [0, 10], "For": 0, "convert": 0, "appli": [0, 5], "function": [0, 1, 2, 3, 4, 5, 6, 7], "she": 0, "left": 0, "store": [0, 5, 8], "should": [0, 3, 7], "he": 0, "sentenc": 0, "unchang": 0, "call": [0, 1, 2, 5, 7], "directli": [0, 3], "generate_all_vari": 0, "d": [0, 4], "It": [0, 2, 10], "replac": [0, 5], "second": [0, 3], "so": [0, 8], "number": [0, 4, 6], "exponenti": 0, "remov": [0, 4, 5, 8], "duplic": 0, "If": [0, 4, 5, 6], "keep": 0, "too": 0, "iter": [0, 1, 3, 4, 5, 6], "fast": [0, 4], "cheap": 0, "simpleaugment": 0, "doe": [0, 2], "word": 0, "level": 0, "substitut": 0, "between": [0, 2, 3, 4, 8], "follow": [0, 1, 2, 3, 4, 5, 6, 7, 8], "rule": 0, "defin": [0, 3], "json": 0, "correspondance_dict": 0, "word_regex": 0, "za": 0, "z\u00e0": 0, "\u00f6\u00f8": 0, "\u00ff": 0, "substituion": 0, "express": 0, "tupl": [0, 3], "dict": [0, 4, 5, 6], "defaultdict": 0, "gender": 0, "default_converters_path": 0, "from_json": 0, "lambda": [0, 6], "correspond": [0, 2, 7], "form": 0, "cata": 0, "catb": 0, "wa1": 0, "wa2": 0, "wb1": 0, "wb2": 0, "wb": 0, "go": 0, "callabl": [0, 1, 2, 3, 6, 7], "make": [0, 1, 2, 7, 8], "member": 0, "alreadi": 0, "applic": 0, "more": [0, 3, 6, 8], "flexibl": 0, "power": [0, 3], "llmdaugment": 0, "languag": 0, "gener": [0, 2, 3, 4, 5, 6, 8, 10], "techniqu": [0, 10], "ha": [0, 7], "been": [0, 5, 8], "context": [0, 5], "counterfactu": [0, 10], "set": [0, 2], "config": [0, 2, 5], "openai_api_kei": [0, 2], "api": [0, 8, 10], "environ": [0, 2], "variabl": [0, 2], "categories_instruct": 0, "prompt_templ": 0, "engin": 0, "text": [0, 2, 3, 10], "davinci": 0, "002": 0, "fryer": 0, "2022": [0, 4, 8], "http": [0, 4, 8, 9, 10], "aclanthologi": [0, 4, 8], "org": [0, 4, 8], "woah": 0, "1": [0, 4, 7], "20": 0, "pdf": [0, 4, 8], "properti": [0, 3], "default_augment": 0, "small": [0, 4], "grow": [0, 4], "just": [0, 3, 4, 7], "special": 0, "doesn": 0, "t": [0, 1, 3, 7, 8], "case": 0, "One": 0, "wai": [0, 3, 8, 10], "langu": 0, "implement": 0, "here": [0, 7, 9, 10], "llmparaphras": 0, "sens": 1, "perform": [1, 2, 3, 5], "everi": [1, 5], "them": [1, 3, 6], "oper": [1, 5, 6], "inherit": 1, "abstract": [0, 1, 3], "class": [1, 2, 3, 4, 5, 6], "statsaggreg": [1, 2, 3], "arg": 1, "kwd": 1, "save": [1, 3], "load": [1, 10], "displai": 1, "The": [1, 2, 3, 4, 5, 6, 7, 10], "provid": [1, 3, 4, 7, 8, 10], "few": [1, 4], "default": [1, 2, 3, 10], "most": [1, 4, 5, 8], "ones": 1, "probabl": [1, 2, 7], "averageperformancepercategori": 1, "use_geometric_mean": 1, "fals": [1, 5], "comput": [1, 4, 6, 8], "averag": [1, 3], "performancestatspercategori": [1, 3], "mean": [1, 3], "2": 1, "sigma": 1, "uncertainti": 1, "over": 1, "onc": [1, 5, 7, 8], "your": [1, 2, 3, 6, 7, 8, 10], "augment": [1, 6, 10], "chosen": 1, "how": [1, 2, 4, 6, 7, 10], "simpli": 1, "evalut": [1, 8], "float": [1, 2, 3, 4, 5, 7], "print": [1, 3], "result": [1, 2, 3], "save_aggreg": 1, "evaluate_and_print": [1, 3], "evaluate_and_sav": [1, 3], "also_print": 1, "true": [1, 4, 5], "bool": [1, 5], "modul": [2, 5, 6, 7, 8, 10], "agnost": 2, "toward": 2, "all": [2, 8], "given": [2, 3, 5, 6], "usual": [2, 4], "zero": 2, "better": [2, 4], "whichev": 2, "want": [2, 3, 4, 6, 7, 8], "long": [2, 6], "support": [2, 4, 6, 7], "plug": 2, "predict": [2, 7], "measur": [2, 10], "well": [2, 10], "match": [2, 7], "openai": 2, "compat": 2, "declar": 2, "openai_api_bas": [], "url": 2, "api_to_generative_model": [2, 7], "openai_engin": 2, "ada": 2, "001": 2, "generativemodel": [2, 7], "take": [2, 4, 7], "log": [2, 4], "token": [2, 6, 7], "cost": [2, 4], "len": 2, "sum": 2, "ouput": [2, 7], "sequenc": [2, 3, 7], "final": [2, 5, 7], "get_generative_model_evalu": [2, 7, 8], "metric": [2, 7, 10], "perplex": [2, 7], "see": [2, 4, 6, 7, 8], "countergentorch": [2, 3, 4, 5, 6, 7, 8], "contain": [2, 4, 7], "build": [2, 3, 6], "pytorch": [2, 4, 6, 10], "classif": [2, 6, 7, 8], "pip": [3, 8], "venv": [3, 8], "either": 3, "exist": 3, "tool": [2, 3, 7, 8, 10], "librari": [3, 7, 8, 9], "raw": 3, "own": [3, 10], "scratch": 3, "hold": [2, 3], "same": [3, 5, 6], "get_vari": 3, "still": 3, "procud": 3, "associ": 3, "alia": [], "field": 7, "0": [4, 7], "turn": [3, 6, 8], "modelevalu": [3, 7, 8, 10], "third": 3, "pass": [2, 3, 5, 8], "aggreg": [3, 10], "By": 3, "kind": 3, "specifi": 3, "other": [3, 4, 8], "altern": 3, "And": [3, 8], "": [3, 4, 7, 8], "easili": [3, 8, 10], "edit": [3, 6, 7, 10], "decreas": 3, "gap": 3, "click": 3, "next": 3, "know": [3, 8], "activationsdataset": [4, 6, 8], "previou": 4, "section": [4, 8, 10], "vector": [4, 5, 7], "meaning": 4, "three": [4, 8], "we": [4, 8], "dataset": [4, 6, 8, 10], "x_data": [4, 6], "y_data": [4, 6], "appropri": [4, 10], "shape": [4, 5, 6], "work": [4, 7, 8, 10], "inlp": [4, 8], "n_dim": 4, "8": 4, "n_training_it": 4, "400": 4, "ravfogel": [4, 8], "2020": [4, 8], "acl": [4, 8], "main": [4, 8], "647": [4, 8], "int": 4, "tensor": [4, 5, 6, 7], "rlace": [4, 8], "dev_d": 4, "none": [0, 2, 4, 7], "devic": [4, 7], "cpu": 4, "out_it": 4, "75000": 4, "in_iters_adv": 4, "in_iters_clf": 4, "epsilon": 4, "0015": 4, "batch_siz": 4, "128": 4, "evalaute_everi": 4, "1000": 4, "optimizer_class": 4, "torch": 4, "optim": [4, 7], "sgd": 4, "optimizer_params_p": 4, "lr": 4, "005": 4, "weight_decai": 4, "0001": 4, "optimizer_params_predictor": 4, "eval_clf_param": 4, "alpha": 4, "iters_no_chang": 4, "15": 4, "loss": 4, "max_it": 4, "25000": 4, "tol": 4, "num_clfs_in_ev": 4, "3": [4, 10], "activ": [4, 5, 6, 8, 10], "train": 4, "data": [4, 6, 8, 10], "valid": 4, "dimens": [4, 5], "neutral": 4, "batch": 4, "run": [4, 7], "adversari": 4, "predictor": 4, "stop": 4, "criterion": 4, "ab": 4, "acc": 4, "major": 4, "after": 4, "mani": [4, 7], "current": 4, "adam": 4, "etc": 4, "p": 4, "param": 4, "theta": 4, "classifi": [4, 8, 10], "chang": 4, "larg": 4, "high": 4, "dimension": 4, "arxiv": [4, 8], "2201": [4, 8], "12091": [4, 8], "adapt": 4, "github": [4, 10], "com": [4, 9, 10], "shauli": 4, "icml": 4, "blob": 4, "2d9b6d03f65416172b4a2ca7f6da10e374002e5f": 4, "py": 4, "bottlenecked_mlp_span": 4, "bottleneck": 4, "mlp": [4, 8], "A": [4, 5, 8, 10], "linear": [4, 8], "layer": 4, "64": 4, "relu": 4, "tell": 4, "u": 4, "matter": [4, 5, 7], "fastest": 4, "slow": 4, "somewhat": 4, "veri": 4, "onli": [4, 7, 10], "contrast": 4, "two": [4, 7, 10], "linearli": 4, "becaus": [4, 8], "k": 4, "give": [4, 8], "wherea": 4, "There": 4, "yet": [4, 6, 7], "automat": 4, "decid": 4, "network": [4, 5, 6], "respons": 4, "those": [4, 8], "found": [5, 8, 10], "direct": [5, 10], "inform": [5, 10], "project": [5, 6, 8, 10], "dure": [5, 8], "forward": [5, 8], "modif": [5, 8], "describ": 5, "configur": [2, 5, 8], "replacementconfig": 5, "module_nam": 5, "old_modul": 5, "dir": 5, "has_leftov": 5, "wish": 5, "2d": [5, 6], "n": 5, "hidden_dim": 5, "to_proj": 5, "sth": 5, "rather": 5, "than": 5, "simpl": [5, 10], "get_edit_config": [5, 8], "named_modul": 5, "edit_model": [5, 8], "new": [5, 8], "vari": 6, "across": 6, "quickli": [6, 10], "from_augmented_sampl": 6, "assum": 6, "float32": 6, "hidden_dimens": 6, "1d": 6, "group": 6, "part": [6, 10], "togeth": 6, "multiclass": 6, "someth": [6, 7], "precis": 6, "yourself": 6, "activation_util": 6, "get_activ": 6, "batchencod": 6, "haven": 7, "read": 7, "similar": 7, "while": [7, 10], "local": [7, 8, 10], "access": [7, 8], "full": 7, "logit": 7, "pt_to_generative_model": [7, 8], "out": [7, 10], "input_id": 7, "attention_mask": 7, "attribut": 7, "get_classification_model_evalu": [7, 8], "label": 7, "correct_prob": 7, "pair": [7, 8], "__call__": 7, "must": 7, "return_tensor": 7, "pt": 7, "argument": 7, "correct": 7, "accuraci": 7, "top": 7, "otherwis": 7, "valueerror": 7, "pipelin": 7, "hugginfac": 7, "get_classification_pipline_evalu": 7, "note": [2, 7], "last": 7, "won": 7, "let": [7, 8], "weight": [7, 8], "fail": 7, "abl": 8, "common": 8, "don": 8, "user": 8, "what": [8, 10], "inner": 8, "fine": 8, "grain": 8, "base": 8, "extract": 8, "place": 8, "natur": 8, "featur": 8, "combin": 8, "neuron": 8, "often": 8, "captur": 8, "human": 8, "understand": 8, "concept": 8, "care": 8, "advantag": 8, "disadvantag": 8, "span": 8, "detail": 8, "distinct": 8, "treat": 8, "equal": 8, "now": 8, "again": 8, "export": 8, "would": 8, "These": [], "framework": 10, "nlp": 10, "reduc": 10, "unwant": 10, "bia": 10, "offer": 10, "state": 10, "art": 10, "add": 10, "free": 10, "open": 10, "sourc": 10, "code": 10, "fabienrog": 10, "split": 10, "lightweight": 10, "python": 10, "analyz": 10, "check": 10, "usag": 10, "further": 10, "instal": 10, "under": 10, "develop": 10, "pleas": 10, "report": 10, "issu": 10, "repositori": 10, "version": 10, "7": 10, "abov": 10, "demo": 10, "outlin": 10, "process": 10, "b": 10, "select": 10, "intern": 10, "relev": 10, "colab": 9, "research": 9, "googl": 9, "drive": 9, "1j6zahrfpfqsyxla1hm_kqcqlkcd3kvpc": 9, "apiconfig": [0, 2], "base_url": 2, "openai_api_base_url": 2, "instead": 2, "global": 2, "api_util": 2}, "objects": {"countergen": [[0, 0, 1, "", "AugmentedDataset"], [0, 0, 1, "", "Dataset"], [0, 0, 1, "", "LlmParaphraser"], [0, 0, 1, "", "LlmdAugmenter"], [0, 0, 1, "", "Sample"], [0, 0, 1, "", "SimpleAugmenter"], [2, 3, 1, "", "api_to_generative_model"], [1, 3, 1, "", "evaluate"], [1, 3, 1, "", "evaluate_and_print"], [1, 3, 1, "", "evaluate_and_save"], [0, 3, 1, "", "generate_all_variations"], [2, 3, 1, "", "get_generative_model_evaluator"]], "countergen.AugmentedDataset": [[0, 1, 1, "", "from_default"]], "countergen.Dataset": [[0, 1, 1, "", "from_default"], [0, 1, 1, "", "from_jsonl"]], "countergen.LlmdAugmenter": [[0, 2, 1, "", "categories"], [0, 1, 1, "", "from_default"], [0, 1, 1, "", "transform"]], "countergen.SimpleAugmenter": [[0, 1, 1, "", "from_default"], [0, 1, 1, "", "from_json"], [0, 1, 1, "", "transform"]], "countergen.aggregators": [[1, 0, 1, "", "AveragePerformancePerCategory"], [1, 0, 1, "", "PerformanceStatsPerCategory"]], "countergen.tools.api_utils": [[2, 0, 1, "", "ApiConfig"]], "countergen.types": [[3, 0, 1, "", "AugmentedSample"], [0, 0, 1, "", "Augmenter"], [2, 4, 1, "", "ModelEvaluator"], [1, 0, 1, "", "StatsAggregator"], [3, 0, 1, "", "Variation"]], "countergen.types.AugmentedSample": [[3, 1, 1, "", "get_variations"], [3, 2, 1, "", "input"], [3, 2, 1, "", "outputs"]], "countergen.types.Augmenter": [[0, 2, 1, "", "categories"], [0, 1, 1, "", "transform"]], "countergentorch": [[5, 0, 1, "", "ReplacementConfig"], [4, 3, 1, "", "bottlenecked_mlp_span"], [5, 3, 1, "", "edit_model"], [7, 3, 1, "", "get_classification_model_evaluator"], [7, 3, 1, "", "get_classification_pipline_evaluator"], [5, 3, 1, "", "get_edit_configs"], [7, 3, 1, "", "get_generative_model_evaluator"], [4, 3, 1, "", "inlp"], [7, 3, 1, "", "pt_to_generative_model"], [4, 3, 1, "", "rlace"]], "countergentorch.ReplacementConfig": [[5, 5, 1, "", "dirs"], [5, 5, 1, "", "has_leftover"], [5, 5, 1, "", "module_name"], [5, 5, 1, "", "old_module"]], "countergentorch.editing.activation_utils": [[6, 3, 1, "", "get_activations"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property", "3": "py:function", "4": "py:data", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"], "3": ["py", "function", "Python function"], "4": ["py", "data", "Python data"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"data": [0, 3], "load": [0, 2, 3, 7, 8], "augment": [0, 3], "A": 0, "default": 0, "dataset": 0, "b": 0, "your": 0, "The": 0, "class": 0, "two": 0, "paraphras": 0, "model": [1, 2, 3, 5, 7, 8], "evalu": [1, 3], "aggreg": 1, "select": 1, "what": 2, "i": 2, "modelevalu": 2, "creat": 2, "from": 2, "an": 2, "api": 2, "local": 2, "usag": [3, 8], "instal": [3, 8], "outlin": [3, 8], "process": [3, 8], "find": [4, 8], "relev": [4, 8], "direct": [4, 8], "edit": [5, 8], "measur": [6, 8], "intern": [6, 8], "bia": [6, 8], "pytorch": [7, 8], "demo": 9, "welcom": 10, "countergen": 10, "": 10, "document": 10, "content": 10, "countergentorch": 10}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"Editing the Model": [[5, "editing-the-model"], [8, "editing-the-model"]], "Finding the Relevant Directions": [[8, "finding-the-relevant-directions"], [4, "finding-the-relevant-directions"]], "Measuring Internal Bias": [[8, "measuring-internal-bias"], [6, "measuring-internal-bias"]], "PyTorch Model Loading": [[8, "pytorch-model-loading"], [7, "pytorch-model-loading"]], "Usage": [[8, "usage"], [3, "usage"]], "Installation": [[8, "installation"], [3, "installation"]], "Outline of the editing process": [[8, "outline-of-the-editing-process"]], "Demos": [[9, "demos"]], "Data Loading and Augmentation": [[0, "data-loading-and-augmentation"]], "A. Loading default augmented datasets": [[0, "a-loading-default-augmented-datasets"]], "B. Loading your data and augmenting it": [[0, "b-loading-your-data-and-augmenting-it"]], "Data Loading": [[0, "data-loading"]], "Data Augmentation : The Augmenter class": [[0, "data-augmentation-the-augmenter-class"]], "The two default Augmenters": [[0, "the-two-default-augmenters"]], "Paraphrasing": [[0, "paraphrasing"]], "Model Evaluation": [[1, "model-evaluation"], [1, "id1"], [3, "model-evaluation"]], "Aggregator Selection": [[1, "aggregator-selection"]], "Model Loading": [[3, "model-loading"], [2, "model-loading"]], "Outline of the evaluation process": [[3, "outline-of-the-evaluation-process"]], "Data Augmentation": [[3, "data-augmentation"]], "What is a ModelEvaluator": [[2, "what-is-a-modelevaluator"]], "Create ModelEvaluator from an API": [[2, "create-modelevaluator-from-an-api"]], "Create ModelEvaluator from a local model": [[2, "create-modelevaluator-from-a-local-model"]], "Welcome to Countergen\u2019s documentation!": [[10, "welcome-to-countergen-s-documentation"]], "Contents": [[10, "contents"]], "countergen": [[10, null]], "countergentorch": [[10, null]]}, "indexentries": {}})